---
layout:     post                    # 使用的布局(不需要改)
title:      常用命令记录             # 标题
subtitle:   网上以讹传讹的所谓教程太多了,只好把我自己用的命令保存下来 #副标题
date:       2019-10-11 00:00:00 GMT+0800             # 时间
author:     Zen                 # 作者
header-img: img/photo/jiuzhaigou.webp    #这篇文章标题背景图片
catalog: True                       # 是否归档
tags:                               #标签
    - 常识
---

纯粹个人记录

----
# ffmpeg 相关

**截取分段视频**

`ffmpeg -ss 00:00:00 -t 00:09:00 -i "NieR_Automata 同伴的行踪2.mp4" -vcodec copy -acodec copy "NieR_Automata 同伴的行踪2P1.mp4"`

`ffmpeg -ss 00:09:00 -i "NieR_Automata 同伴的行踪2.mp4" -vcodec copy -acodec copy "NieR_Automata 同伴的行踪2P2.mp4"`

```-ss 启始时间 -t 持续时间 无t参数截取到结束```

**合成M4S**

`ffmpeg -i video.m4s -i audio.m4s -codec copy multi.mp4`

**批量转换格式**

`for %a in ("*.mp4") do ffmpeg -i "%a" "%~na.gif"`

**旋转视频**

```
ffmpeg -i <inputfile> -vf "transpose=2,transpose=2" <outputfile>
ffmpeg -i 4.avi -vf "transpose=1" 4done.avi
其中transpose取值:
0 = 90CounterCLockwise and Vertical Flip (default)
1 = 90Clockwise
2 = 90CounterClockwise
3 = 90Clockwise and Vertical Flip
```

**音视频合并**

`ffmpeg -i video.mp4 -i audio.wav -c:v copy -c:a aac -strict experimental output.mp4`

**抽取音频命令**

`ffmpeg -i 3.mp4 -vn -y -acodec copy 3.m4a`

**提取视频**

`ffmpeg -i Life.of.Pi.has.subtitles.mkv -vcodec copy –an  videoNoAudioSubtitle.mp4`

**替换音频合并**

`ffmpeg -i video.mp4 -i audio.wav -c:v copy -c:a aac -strict experimental -map 0:v:0 -map 1:a:0 output.mp4`

**提取视频的音频**

`ffmpeg -i input.mp4 -vn -y -acodec copy output.m4a`

**去除视频音频**

`ffmpeg -i input.mp4 -an output.mp4`

**抽取音频命令**

~~`ffmpeg -i 3.mp4 -vn -y -acodec copy 3.aac`~~

`ffmpeg -i 3.mp4 -vn -y -acodec copy 3.m4a`

**拼接AVI视频**

`ffmpeg -f concat -safe 0 -i work.txt -c copy /Users/zen/Movies/out.avi`

其中`work.txt`文件格式类似

```
file /Users/zen/Downloads/redisLesson/video/001.avi
file /Users/zen/Downloads/redisLesson/video/002.avi
file /Users/zen/Downloads/redisLesson/video/003.avi
file /Users/zen/Downloads/redisLesson/video/004.avi
file /Users/zen/Downloads/redisLesson/video/005.avi
file /Users/zen/Downloads/redisLesson/video/006.avi
file /Users/zen/Downloads/redisLesson/video/007.avi
file /Users/zen/Downloads/redisLesson/video/008.avi
file /Users/zen/Downloads/redisLesson/video/009.avi
file /Users/zen/Downloads/redisLesson/video/010.avi
```
`并且文件名外只能使用单引号`

# youtube-dl 相关

**指定视频尺寸下载**

`/usr/local/bin/youtube-dl --proxy 127.0.0.1:1086 -f 'bestvideo[height=1080]+bestaudio/best[height<=480]' <url>`

**下载最高分辨率**

`sudo /usr/local/bin/youtube-dl --proxy 127.0.0.1:1080 -f bestvideo+bestaudio <url>`

**同时下载全部可用字幕**

`/usr/local/bin/youtube-dl --proxy 127.0.0.1:1080 --write-sub --all-subs -i -f bestvideo+bestaudio <url>`

**直接下载**

`/usr/local/bin/youtube-dl <url>`

**不检查证书**

`youtube-dl --no-check-certificate --proxy 127.0.0.1:8889 -f bestvideo+bestaudio <url>`

# 组策略 相关

**立即更新组策略配置**

`gpupdate /force`

# shell 相关

**合并m3u8下载的分段视频**

```
#!/bin/bash
# ffmpeg -i "concat:0.ts|1.ts|2.ts|3.ts|4.ts|5.ts|6.ts|7.ts|8.ts|9.ts" -c copy -bsf:a aac_adtstoasc -movflags +faststart output.mp4
ffmpeg -i "concat:0.ts|1.ts|2.ts|3.ts|4.ts|5.ts|6.ts|7.ts|8.ts|9.ts|10.ts|11.ts|12.ts" -c copy -bsf:a aac_adtstoasc -movflags +faststart output.mp4
```

**shell文件头**

`#!/bin/bash`

**macOS仅复制文件目录**

```
find ./1-1 -type d -exec mkdir ./des/{} \;
参数:
-type d : 表示只差早目录
-exec <命令> 空格\;  : 表示把前面查找的结果输入到命令中作为参数,{}会被替换成搜索结果,必须\;结尾
./1-1 : 目标目录,这里可以使绝对路径,可以写相对路径
./des/{} : 表示把结果拷贝到 "./des/....."中
```

**提取视频中的音频重命名并删除原文件**

```
#!/bin/bash

filename=$(ls *.mp4)
echo $filename

ffmpeg -i $filename -vn -y -acodec copy "name.m4a"
rm $filename
```
